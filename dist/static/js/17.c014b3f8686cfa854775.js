webpackJsonp([17],{"6MCF":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("P9l9"),r={data:function(){return{expireTime:"",paramList:[],mobilePhoneNotice:!1,map:null,detailAddress:"",typeList:[],statusList:[{value:1,label:"正常使用"},{value:2,label:"维修中"},{value:3,label:"淘汰未用"}],formItem:{id:"",fixedAssetsName:"",type:"",belongUnit:"",isExpire:"0",expireTime:"",earlierNotice:null,noticeType:"0",status:"",supervisor:"",phone:"",lng:"",lat:"",position:"",pixelX:null,pixelY:null,params:[]}}},methods:{getTypeList:function(){var t=this;Object(s.y)().then(function(e){1e3===e.data.code?t.typeList=e.data.content:t.typeList=[]})},changeType:function(t){""!==t&&void 0!==t?this.getParamPull(t):this.paramList=[]},getParamPull:function(t){var e=this,a={typeId:t};Object(s.h)(a).then(function(t){if(1e3===t.data.code){e.paramList=t.data.content;for(var a=0;a<e.paramList.length;a++)e.paramList[a].value=""}else e.paramList=[]})},changeExpire:function(t){this.formItem.expireTime="",this.formItem.earlierNotice=null,this.formItem.noticeType="0"},changeDate:function(t){this.formItem.expireTime=""!==t&&void 0!==t?t:""},mobilePhoneVal:function(t){this.formItem.phone=t.trim();""!==this.formItem.phone?/(^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$)/.test(t.trim())?this.mobilePhoneNotice=!1:this.mobilePhoneNotice=!0:this.mobilePhoneNotice=!1},loadMap:function(){var t=this,e=new BMap.Map("container",{enableMapClick:!1});t.map=e;var a=new BMap.Point(116.404,39.915);e.centerAndZoom(a,18),e.enableScrollWheelZoom(),new BMap.Autocomplete({input:"searchInput",location:e}).addEventListener("onconfirm",function(e){var a=e.item.value;t.formItem.position=a.province+a.city+a.district+a.street+a.business,t.setPlace()}),t.map.addEventListener("onclick",function(e){t.formItem.lng=e.point.lng,t.formItem.lat=e.point.lat,(new BMap.Geocoder).getLocation(e.point,function(e){var a=e.addressComponents;t.formItem.position=a.province+a.city+a.district+a.street+a.streetNumber})})},setPlace:function(){var t=this;t.map.clearOverlays();var e=new BMap.LocalSearch(t.map,{onSearchComplete:function(){var a=e.getResults().getPoi(0).point;t.formItem.lng=a.lng,t.formItem.lat=a.lat,t.map.centerAndZoom(a,18),t.map.addOverlay(new BMap.Marker(a))}});e.search(this.detailAddress)},submitVal:function(t){return 0===t.fixedAssetsName.trim().length?(this.$Message.error("固定资产名称不能为空！"),!1):""===t.type||void 0===t.type?(this.$Message.error("固定资产分类不能为空！"),!1):0===t.belongUnit.trim().length?(this.$Message.error("所属单位不能为空！"),!1):"1"===t.isExpire&&""===t.expireTime?(this.$Message.error("过期日期不能为空!"),!1):"1"===t.isExpire&&null===t.earlierNotice?(this.$Message.error("提前提醒天数不能为空!"),!1):!this.mobilePhoneNotice||(this.$Message.error("请输入合法的手机号码!"),!1)},save:function(){var t=this;this.formItem.params=[];for(var e=0;e<this.paramList.length;e++){var a={paramId:this.paramList[e].paramId,value:this.paramList[e].value,intro:""};this.formItem.params.push(a)}this.submitVal(this.formItem)&&(""===this.formItem.id||void 0===this.formItem.id?Object(s.m)(this.formItem).then(function(e){1e3===e.data.code?(t.$Message.success("固定资产创建成功！"),t.$router.push({name:"assets"})):t.$Message.error(e.data.message)}):Object(s.l)(this.formItem).then(function(e){1e3===e.data.code?(t.$Message.success("固定资产编辑成功！"),t.$router.push({name:"assets",params:{param:t.$route.params.param}})):t.$Message.error(e.data.message)}))},getDetail:function(t){var e=this,a={fiexdAssetsId:t};Object(s.j)(a).then(function(t){if(1e3===t.data.code){var a=t.data.content;e.formItem=a,e.formItem.isExpire=a.isExpire+"",e.formItem.noticeType=a.noticeType+"",e.expireTime=a.expireTime,e.getParamPull(a.type);for(var s=0;s<a.params.length;s++){var r={paramId:a.params[s].id,value:a.params[s].value,paramName:a.params[s].paramName};e.formItem.params[s]=r,e.paramList[s]=r}}else e.formItem={id:e.$route.params.id,fixedAssetsName:"",type:"",belongUnit:"",isExpire:"0",expireTime:"",earlierNotice:null,noticeType:"0",status:"",supervisor:"",phone:"",lng:"",lat:"",position:"",pixelX:null,pixelY:null}})},back:function(){""===this.formItem.id?this.$router.push({name:"assets"}):this.$router.push({name:"assets",params:{param:this.$route.params.param}})}},mounted:function(){this.loadMap()},created:function(){this.getTypeList(),void 0!==this.$route.params.id&&(this.formItem.id=this.$route.params.id,this.getDetail(this.formItem.id))}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticClass:"titleBar",attrs:{type:"flex",justify:"start"}},[a("Icon",{staticClass:"closeIcon",attrs:{type:"md-close",size:"30"},on:{click:t.back}}),t._v(" "),a("div",{staticStyle:{margin:"10px 30px"}},[a("span",[t._v("\n       固定资产登记\n       "),a("Icon",{attrs:{type:"ios-arrow-forward",size:"20"}})],1),t._v(" "),a("span",[t._v(t._s(""===t.formItem.id?"创建":"编辑")+"固定资产")])])],1),t._v(" "),a("div",{staticClass:"detailBody"},[a("div",{staticClass:"detailContent"},[a("Row",{staticClass:"detailTitle",attrs:{type:"flex",justify:"start"}},[t._v("资产信息")]),t._v(" "),a("div",{staticClass:"formContent"},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":150}},[a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"资产名称"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"请输入资产名称"},model:{value:t.formItem.fixedAssetsName,callback:function(e){t.$set(t.formItem,"fixedAssetsName",e)},expression:"formItem.fixedAssetsName"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"资产分类"}},[a("Select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择资产分类",clearable:""},on:{"on-change":t.changeType},model:{value:t.formItem.type,callback:function(e){t.$set(t.formItem,"type",e)},expression:"formItem.type"}},t._l(t.typeList,function(e){return a("Option",{key:e.typeId,attrs:{value:e.typeId}},[t._v(t._s(e.typeName))])}),1)],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:""!==t.formItem.type&&void 0!==t.formItem.type,expression:"formItem.type !== ''&& formItem.type !== undefined"}],attrs:{label:"分类参数"}},[t._l(t.paramList,function(e,s){return a("div",{key:e.paramId,staticStyle:{"margin-bottom":"5px","text-align":"left"}},[a("span",[t._v(t._s(e.paramName))]),t._v(" - "),a("Input",{staticStyle:{width:"150px"},attrs:{placeholder:"参数值"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)}),t._v(" "),0===t.paramList.length?a("span",{staticClass:"noticeTextGray"},[t._v("暂无分类参数")]):t._e()],2)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"所属单位"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"请输入所属单位"},model:{value:t.formItem.belongUnit,callback:function(e){t.$set(t.formItem,"belongUnit",e)},expression:"formItem.belongUnit"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"设置过期时间"}},[a("RadioGroup",{on:{"on-change":t.changeExpire},model:{value:t.formItem.isExpire,callback:function(e){t.$set(t.formItem,"isExpire",e)},expression:"formItem.isExpire"}},[a("Radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),a("Radio",{attrs:{label:"0"}},[t._v("否")])],1)],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===t.formItem.isExpire,expression:"formItem.isExpire === '1'"}]},[a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"过期日期"}},[a("DatePicker",{staticStyle:{float:"left",width:"300px"},attrs:{type:"datetime",placeholder:"过期日期",editable:!1},on:{"on-change":t.changeDate},model:{value:t.expireTime,callback:function(e){t.expireTime=e},expression:"expireTime"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"提前提醒天数"}},[a("InputNumber",{staticStyle:{width:"300px","margin-right":"5px"},attrs:{formatter:function(t){return(""+t).replace(".","")},parser:function(t){return t.replace("-","")}},model:{value:t.formItem.earlierNotice,callback:function(e){t.$set(t.formItem,"earlierNotice",e)},expression:"formItem.earlierNotice"}}),t._v("\n                天\n              ")],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"提醒方式"}},[a("RadioGroup",{model:{value:t.formItem.noticeType,callback:function(e){t.$set(t.formItem,"noticeType",e)},expression:"formItem.noticeType"}},[a("Radio",{attrs:{label:"0"}},[t._v("手机短信")]),t._v(" "),a("Radio",{attrs:{label:"1"}},[t._v("消息推送")])],1)],1)],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"资产状态"}},[a("Select",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"资产状态",clearable:""},model:{value:t.formItem.status,callback:function(e){t.$set(t.formItem,"status",e)},expression:"formItem.status"}},t._l(t.statusList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"监管人姓名"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"请输入监管人姓名"},model:{value:t.formItem.supervisor,callback:function(e){t.$set(t.formItem,"supervisor",e)},expression:"formItem.supervisor"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"联系电话"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"请输入联系电话"},on:{"on-change":function(e){return t.mobilePhoneVal(t.formItem.phone)}},model:{value:t.formItem.phone,callback:function(e){t.$set(t.formItem,"phone",e)},expression:"formItem.phone"}}),t._v(" "),t.mobilePhoneNotice?a("span",{staticClass:"notice"},[t._v("请输入合法的手机号码")]):t._e()],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"详细地址"}},[""===t.formItem.position?a("span",{staticClass:"noticeTextGray"},[t._v("请在地图上点击选择地址或输入框搜索地址")]):t._e(),t._v("\n              "+t._s(t.formItem.position)+"\n            ")])],1),t._v(" "),a("Row",{staticStyle:{height:"430px"},attrs:{type:"flex",justify:"start"}},[a("Col",{attrs:{span:"15"}},[a("FormItem",[a("div",{attrs:{id:"outer-box"}},[a("div",{attrs:{id:"container",tabindex:"0"}}),t._v(" "),a("div",{attrs:{id:"panel"}},[a("input",{attrs:{id:"searchInput",placeholder:"输入关键字搜索地址"}}),t._v(" "),a("div",{attrs:{id:"searchResults"}})])])])],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"资产经度"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"例如116.404"},model:{value:t.formItem.lng,callback:function(e){t.$set(t.formItem,"lng",e)},expression:"formItem.lng"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"资产纬度"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"例如39.915"},model:{value:t.formItem.lat,callback:function(e){t.$set(t.formItem,"lat",e)},expression:"formItem.lat"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"实景图中像素位置X"}},[a("InputNumber",{staticStyle:{width:"300px",float:"left"},model:{value:t.formItem.pixelX,callback:function(e){t.$set(t.formItem,"pixelX",e)},expression:"formItem.pixelX"}})],1)],1),t._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"实景图中像素位置Y"}},[a("InputNumber",{staticStyle:{width:"300px",float:"left"},model:{value:t.formItem.pixelY,callback:function(e){t.$set(t.formItem,"pixelY",e)},expression:"formItem.pixelY"}})],1)],1)],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex"}},[a("Button",{staticClass:"btn-save",staticStyle:{padding:"5px 30px"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(r,i,!1,function(t){a("nWsH")},"data-v-77ba22a9",null);e.default=o.exports},nWsH:function(t,e){}});
//# sourceMappingURL=17.c014b3f8686cfa854775.js.map