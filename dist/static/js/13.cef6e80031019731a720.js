webpackJsonp([13],{Avgo:function(e,t){},fex2:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),s=a.n(i),r=a("P9l9"),o={data:function(){return{repairTime:"",fixedType:"",typeList:[],fixedList:[],mobilePhoneNotice:!1,typeImage:"",formItem:{id:"",fiexdAssetsId:"",repairContent:"",imageId:"",repairer:"",phone:"",repairTime:"",type:"2"}}},methods:{getTypeList:function(){var e=this;Object(r.y)().then(function(t){1e3===t.data.code?e.typeList=t.data.content:e.typeList=[]})},changeType:function(e){this.getFixed(e)},getFixed:function(e){var t=this,a={typeId:e};Object(r.n)(a).then(function(e){1e3===e.data.code?t.fixedList=e.data.content:t.fixedList=[]})},mobilePhoneVal:function(e){this.formItem.phone=e.trim();/(^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$)/.test(e.trim())?this.mobilePhoneNotice=!1:this.mobilePhoneNotice=!0},handleUpload:function(e){var t=this,a=new FormData,i=!0,o=!1,n=void 0;try{for(var l,m=s()(e.target.files);!(i=(l=m.next()).done);i=!0){var d=l.value;a.append("file",d)}}catch(e){o=!0,n=e}finally{try{!i&&m.return&&m.return()}finally{if(o)throw n}}Object(r._9)(a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){1e3===e.data.code?(t.typeImage=e.data.content.url,t.formItem.imageId=e.data.content.id):t.$Message.error(e.data.message),t.$refs.upload.value=""})},removeImage:function(){this.typeImage="",this.formItem.imageId=""},changeDate:function(e){this.formItem.repairTime=""!==e&&void 0!==e?e:""},submitVal:function(e){return""===this.fixedType||void 0===this.fixedType?(this.$Message.error("资产分类不能为空！"),!1):""===e.fiexdAssetsId||void 0===e.fiexdAssetsId?(this.$Message.error("固定资产不能为空！"),!1):0===e.repairer.trim().length?(this.$Message.error("维护人姓名不能为空！"),!1):""===e.phone?(this.$Message.error("手机号码不能为空！"),!1):!0===this.mobilePhoneNotice?(this.$Message.error("请输入合法的手机号码！"),!1):""!==e.repairTime||(this.$Message.error("维护时间不能为空！"),!1)},save:function(){var e=this;this.submitVal(this.formItem)&&(""===this.formItem.id||void 0===this.formItem.id?Object(r.o)(this.formItem).then(function(t){1e3===t.data.code?(e.$Message.success("维护记录创建成功！"),e.$router.push({name:"assets_Main"})):e.$Message.error(t.data.message)}):Object(r.s)(this.formItem).then(function(t){1e3===t.data.code?(e.$Message.success("维护记录编辑成功！"),e.$router.push({name:"assets_Main",params:{param:e.$route.params.param}})):e.$Message.error(t.data.message)}))},getDetail:function(e){var t=this,a={repairId:e};Object(r.q)(a).then(function(e){if(1e3===e.data.code){var a=e.data.content;t.formItem={id:a.id,fiexdAssetsId:a.fiexdAssetsId,repairContent:a.repairContent,imageId:a.imageId,repairer:a.repairer,phone:a.phone,repairTime:a.repairTime,type:a.type+""},t.repairTime=a.repairTime,t.fixedType=a.fixedTypeId,t.getFixed(a.fixedTypeId),t.typeImage=a.imageUrl}else t.formItem={id:t.$route.params.id,fiexdAssetsId:"",repairContent:"",imageId:"",repairer:"",phone:"",repairTime:""}})},back:function(){""===this.formItem.id?this.$router.push({name:"assets_Main"}):this.$router.push({name:"assets_Main",params:{param:this.$route.params.param}})}},created:function(){this.getTypeList(),void 0!==this.$route.params.id&&(this.formItem.id=this.$route.params.id,this.getDetail(this.formItem.id))}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{staticClass:"titleBar",attrs:{type:"flex",justify:"start"}},[a("Icon",{staticClass:"closeIcon",attrs:{type:"md-close",size:"30"},on:{click:e.back}}),e._v(" "),a("div",{staticStyle:{margin:"10px 30px"}},[a("span",[e._v("\n       固定资产管维\n       "),a("Icon",{attrs:{type:"ios-arrow-forward",size:"20"}})],1),e._v(" "),a("span",[e._v(e._s(""===e.formItem.id?"创建":"编辑")+"维护记录")])])],1),e._v(" "),a("div",{staticClass:"detailBody"},[a("div",{staticClass:"detailContent"},[a("Row",{staticClass:"detailTitle",attrs:{type:"flex",justify:"start"}},[e._v("维护记录")]),e._v(" "),a("div",{staticClass:"formContent"},[a("Form",{ref:"formItem",attrs:{model:e.formItem,"label-width":150}},[a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"资产分类"}},[a("Select",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"资产分类",clearable:""},on:{"on-change":e.changeType},model:{value:e.fixedType,callback:function(t){e.fixedType=t},expression:"fixedType"}},e._l(e.typeList,function(t){return a("Option",{key:t.typeId,attrs:{value:t.typeId}},[e._v(e._s(t.typeName))])}),1)],1)],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"资产名称"}},[a("Select",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"资产名称",clearable:""},model:{value:e.formItem.fiexdAssetsId,callback:function(t){e.$set(e.formItem,"fiexdAssetsId",t)},expression:"formItem.fiexdAssetsId"}},e._l(e.fixedList,function(t){return a("Option",{key:t.fixedId,attrs:{value:t.fixedId}},[e._v(e._s(t.fixedName))])}),1)],1)],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"维护类型"}},[a("RadioGroup",{model:{value:e.formItem.type,callback:function(t){e.$set(e.formItem,"type",t)},expression:"formItem.type"}},[a("Radio",{attrs:{label:"2"}},[e._v("维护保养")]),e._v(" "),a("Radio",{attrs:{label:"1"}},[e._v("损坏维修")])],1)],1)],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"维护人姓名"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"维护人姓名"},model:{value:e.formItem.repairer,callback:function(t){e.$set(e.formItem,"repairer",t)},expression:"formItem.repairer"}}),a("br")],1)],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"手机号码"}},[a("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"手机号码"},on:{"on-change":function(t){return e.mobilePhoneVal(e.formItem.phone)}},model:{value:e.formItem.phone,callback:function(t){e.$set(e.formItem,"phone",t)},expression:"formItem.phone"}}),e._v(" "),e.mobilePhoneNotice?a("span",{staticClass:"notice"},[e._v("请输入合法的手机号码")]):e._e(),a("br")],1)],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{staticClass:"selfValidate",attrs:{label:"维护时间"}},[a("DatePicker",{staticStyle:{float:"left",width:"300px"},attrs:{type:"datetime",placeholder:"维护时间",editable:!1},on:{"on-change":e.changeDate},model:{value:e.repairTime,callback:function(t){e.repairTime=t},expression:"repairTime"}})],1)],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"维护图片"}},[a("div",{staticClass:"file"},[a("input",{ref:"upload",staticStyle:{height:"30px"},attrs:{type:"file"},on:{change:e.handleUpload}}),e._v("上传图片\n              ")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.typeImage&&null!==e.typeImage,expression:"typeImage !== '' && typeImage !== null"}],staticClass:"box-image"},[a("a",{attrs:{href:e.typeImage,target:"_blank"}},[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.typeImage,alt:"上传照片"}})]),e._v(" "),a("div",{staticClass:"mask-image"},[a("Icon",{attrs:{type:"ios-trash-outline",size:"24",color:"#fff"},nativeOn:{click:function(t){return e.removeImage(t)}}})],1)])])],1),e._v(" "),a("Row",{attrs:{type:"flex"}},[a("FormItem",{attrs:{label:"维护内容"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:"100","show-word-limit":"",type:"textarea",placeholder:"请输入维护内容",autosize:{minRows:2,maxRows:5}},model:{value:e.formItem.repairContent,callback:function(t){e.$set(e.formItem,"repairContent",t)},expression:"formItem.repairContent"}}),a("br")],1)],1)],1)],1)],1),e._v(" "),a("Row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex"}},[a("Button",{staticClass:"btn-save",staticStyle:{padding:"5px 30px"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(o,n,!1,function(e){a("Avgo")},"data-v-bd4075bc",null);t.default=l.exports}});
//# sourceMappingURL=13.cef6e80031019731a720.js.map