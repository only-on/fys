webpackJsonp([14],{Rf7G:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("BO1k"),r=e.n(s),i=e("P9l9"),m={data:function(){return{typeImage:"",paramList:[{paramId:-1,paramName:""}],paramFlag:!0,formItem:{id:"",typeName:"",describ:"",iconId:"",params:""}}},methods:{handleUpload:function(t){var a=this,e=new FormData,s=!0,m=!1,o=void 0;try{for(var n,l=r()(t.target.files);!(s=(n=l.next()).done);s=!0){var p=n.value;e.append("file",p)}}catch(t){m=!0,o=t}finally{try{!s&&l.return&&l.return()}finally{if(m)throw o}}Object(i._9)(e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){1e3===t.data.code?(a.typeImage=t.data.content.url,a.formItem.iconId=t.data.content.id):a.$Message.error(t.data.message),a.$refs.upload.value=""})},removeImage:function(){this.typeImage="",this.formItem.iconId=""},addParam:function(){var t={paramId:-1,paramName:""};if(this.paramList.length>0){var a=this.paramList[this.paramList.length-1].paramName.trim();if(""===a)this.$Message.error("请填写分类参数");else{for(var e=0;e<this.paramList.length-1;e++)if(a===this.paramList[e].paramName.trim()){this.$Message.error("分类参数相同"),this.paramFlag=!1;break}this.paramFlag&&this.paramList.push(t)}}else this.paramList.push(t)},removeParam:function(t,a){var e=this;if(-1===a)this.paramList.splice(t,1);else{var s={paramId:a};Object(i.v)(s).then(function(a){1e3===a.data.code?e.paramList.splice(t,1):e.$Message.error(a.data.message)})}},submitVal:function(t){return 0===t.typeName.trim().length?(this.$Message.error("分类名称不能为空！"),!1):t.typeName.trim().length>30?(this.$Message.error("分类名称不能超过30字！"),!1):""===t.iconId?(this.$Message.error("分类图片不能为空！"),!1):0!==t.describ.trim().length||(this.$Message.error("分类描述不能为空！"),!1)},save:function(){var t=this;if(this.submitVal(this.formItem))if(""===this.formItem.id||void 0===this.formItem.id){if(0!==this.paramList.length&&""!==this.paramList[0].paramName){for(var a=0;a<this.paramList.length;a++)this.formItem.params+=this.paramList[a].paramName+",";this.formItem.params.substr(0,this.formItem.params.length-1)}Object(i.t)(this.formItem).then(function(a){1e3===a.data.code?(t.$Message.success("分类创建成功！"),t.$router.push({name:"assetsCategory"})):t.$Message.error(a.data.message)})}else this.formItem.params=this.paramList,Object(i.z)(this.formItem).then(function(a){1e3===a.data.code?(t.$Message.success("分类编辑成功！"),t.$router.push({name:"assetsCategory",params:{param:t.$route.params.param}})):t.$Message.error(a.data.message)})},getDetail:function(t){var a=this,e={fixedTypeId:t};Object(i.w)(e).then(function(t){if(1e3===t.data.code){var e=t.data.content;a.formItem={id:e.id,typeName:e.typeName,describ:e.describ,iconId:e.iconId,params:e.params},a.typeImage=e.url,a.paramList=a.formItem.params}else a.formItem={id:a.$route.params.id,typeName:"",describ:"",iconId:"",params:""}})},back:function(){""===this.formItem.id?this.$router.push({name:"assetsCategory"}):this.$router.push({name:"assetsCategory",params:{param:this.$route.params.param}})}},created:function(){void 0!==this.$route.params.id&&(this.formItem.id=this.$route.params.id,this.getDetail(this.formItem.id))}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("Row",{staticClass:"titleBar",attrs:{type:"flex",justify:"start"}},[e("Icon",{staticClass:"closeIcon",attrs:{type:"md-close",size:"30"},on:{click:t.back}}),t._v(" "),e("div",{staticStyle:{margin:"10px 30px"}},[e("span",[t._v("\n       资产分类管理\n       "),e("Icon",{attrs:{type:"ios-arrow-forward",size:"20"}})],1),t._v(" "),e("span",[t._v(t._s(""===t.formItem.id?"创建":"编辑")+"分类")])])],1),t._v(" "),e("div",{staticClass:"detailBody"},[e("div",{staticClass:"detailContent"},[e("Row",{staticClass:"detailTitle",attrs:{type:"flex",justify:"start"}},[t._v("分类信息")]),t._v(" "),e("div",{staticClass:"formContent"},[e("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":150}},[e("Row",{attrs:{type:"flex"}},[e("FormItem",{staticClass:"selfValidate",attrs:{label:"分类名称"}},[e("Input",{staticStyle:{width:"300px",float:"left"},attrs:{placeholder:"请输入分类名称"},model:{value:t.formItem.typeName,callback:function(a){t.$set(t.formItem,"typeName",a)},expression:"formItem.typeName"}}),e("br")],1)],1),t._v(" "),e("Row",{attrs:{type:"flex"}},[e("FormItem",{staticClass:"selfValidate",attrs:{label:"分类图片"}},[e("div",{staticClass:"file"},[e("input",{ref:"upload",staticStyle:{height:"30px"},attrs:{type:"file"},on:{change:t.handleUpload}}),t._v("上传图片\n              ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:""!==t.typeImage,expression:"typeImage !== ''"}],staticClass:"box-image"},[e("a",{attrs:{href:t.typeImage,target:"_blank"}},[e("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.typeImage,alt:"上传照片"}})]),t._v(" "),e("div",{staticClass:"mask-image"},[e("Icon",{attrs:{type:"ios-trash-outline",size:"24",color:"#fff"},nativeOn:{click:function(a){return t.removeImage(a)}}})],1)])])],1),t._v(" "),e("Row",{attrs:{type:"flex"}},[e("FormItem",{staticClass:"selfValidate",attrs:{label:"分类描述"}},[e("Input",{staticStyle:{width:"300px"},attrs:{maxlength:"100","show-word-limit":"",type:"textarea",placeholder:"请输入分类描述",autosize:{minRows:2,maxRows:5}},model:{value:t.formItem.describ,callback:function(a){t.$set(t.formItem,"describ",a)},expression:"formItem.describ"}}),e("br")],1)],1),t._v(" "),e("Row",{attrs:{type:"flex"}},[e("FormItem",{attrs:{label:"分类参数"}},[t._l(t.paramList,function(a,s){return e("div",{key:s,staticStyle:{display:"flex","align-items":"center"}},[e("Input",{staticStyle:{width:"300px",float:"left","margin-bottom":"5px"},attrs:{placeholder:"请输入分类参数"},model:{value:a.paramName,callback:function(e){t.$set(a,"paramName",e)},expression:"item.paramName"}}),t._v(" "),e("Button",{staticStyle:{color:"#516BEB"},attrs:{type:"text"},on:{click:function(e){return t.removeParam(s,a.paramId)}}},[t._v("删除")])],1)}),t._v(" "),e("Button",{staticStyle:{"margin-top":"10px",float:"left"},attrs:{type:"dashed",icon:"md-add"},on:{click:t.addParam}},[t._v("分类参数")])],2)],1)],1)],1)],1),t._v(" "),e("Row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex"}},[e("Button",{staticClass:"btn-save",staticStyle:{padding:"5px 30px"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var n=e("VU/8")(m,o,!1,function(t){e("aNLP")},"data-v-9b297b66",null);a.default=n.exports},aNLP:function(t,a){}});
//# sourceMappingURL=14.71927058aa368d6545b6.js.map